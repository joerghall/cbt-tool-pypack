language: c++
os:
- linux
- osx
sudo: required
group: travis_lts

git:
  depth: 1000000
env:
  global:
  - secure: "iq2N3o2s3xN2FrARu54DITpTS8ZladHGRyD02H3bg9oxWctkE+9JZdD/dswWuZqsNyeZZNteazarCm3N/3I6OxHicq9CvzJw+F8uuYWoqwgO9f/9BLPC9L9XuBosbOQ8M7H8XszxCqNw/zGi8zeIm60ZKcd6xzzxJOvnmitCq3wHAP5eys9tnAHBKkPsPmMuVBzgxXEti+YBVcUHFKtdFcvemZvKZEOy2ojGtIL8JW4rkMGrUcjyuyOYFNA+i3aCYVVLl5Tdc2EWdHN9JB1glkC7IQ4BnjmU9frCbielJ821gk0vzNltrkhu116xUuRVtcktZovIpK78NYqQyv73NEEQMnh6AJpVD0H3LkdWm/Umu7gNaJeCnO1Oki/iPHh8rExNB5NdCnLREFylpQ5L7Ar/d2Z8NWwBN7S2YBrhh1+UnTXG995qXhGFqUMd3Gapf0RTc4ELimbJWrY2mY8QEHPzJRDq7/wFRZt8juOUTkoGFQ5ECvS9gQu4q7a7Tgp02M8rTMXfylE+ifm9rf0MoeP4twJysqKkGqIGTTpTZPJUarFa8PNyH5vBNWRRx6NpOPNRh7SNgVDKY/TpjwTad0rNPfCaUojJ/oA3wpmmP9m0gmNur2gTK0pv2G6rN3m/OhBrnJBCd/XhvbauWwW4lZgRzD5aG9Nt6lf5XEmWFfs="
  - secure: "goqLz5915KWzldj8A+o3FALQg+tZeqZVMckZEx7R6LTVUaB1TPipai13QHk7i8yUNQzNH7SsZYo2LJtDlZuQFxOG9P7uVTu3uf7rflHDy6Pj2WJEG0e63N1SLqADHdfUzUfe1ikmipXdF3ZHfHeG5me2Op3JepN4uLzpyZhV9t4VdYiPTTuUFcETpiS6aM5YEaBO3/c7cyiWrVA121YEgoSEg0D0esLOoB4M/uMODMg6KcIX8O2Pm1UzDJN+WV1AUPpKVB5AwnPBJU3rReSAkEH/ymvxASfAa7UCt9qIWWGvQDzLaM/+wDIqAOagkJ8SoZ1fyfmOCJrm4Xaxnbzzj3bpStvmi9tsbIsgL0jnr6lFEqKa9WLQolo3z6qV9nOaMoeTqHkBoQ0WmqcjgkUkryhxSO8U2gyxuwMuJFn6GZv3VP+PMWb7x90fJf0JrQ9OYya9pQsFroTc25dKvOc8EOTnidel8lFAJGPx0rSyFRl7FhEqyjLuPvMfbSxlzokUhU9Q/sxpuE57rOS4uJvPpp+LOaPK6PTxVvyvE3WDvFrPpNTomQYpEzZMUD8EqT/ZNLBg7Q/rUQ/SkdxnGonNMrNReAHyC+k5zrNSq2tPjbiVNfFdkntQel+1HqKT8iCeLlbuZmgDtwgRiAUhvzb+i56YT4UA4+Dcn8NCI73HVkI="

before_install:
- if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew install openssl readline ; fi
script:
- if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then docker run -v ${TRAVIS_BUILD_DIR}:/root/pypack -e apikey -e apiuser -e TRAVIS_BRANCH
  --rm -t jhhj/cbt-pypack-centos7:1 /bin/bash -c "mkdir /root/pypack/build
    && cd /root/pypack/build
    && export PATH=/opt/rh/devtoolset-6/root/usr/bin:$PATH
    && cmake -DCMAKE_BUILD_TYPE=Release ..
    && cmake --build . --target publish_python" ; fi
- if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then mkdir ${TRAVIS_BUILD_DIR}/build
    && cd ${TRAVIS_BUILD_DIR}/build && cmake ..
    && cmake --build . --target publish_python ; fi
